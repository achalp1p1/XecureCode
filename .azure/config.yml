name: xecurecode
language: python
runtime: python:3.9

env:
  FLASK_ENV: production
  FLASK_APP: wsgi.py
  WEBSITES_PORT: 8000
  SCM_DO_BUILD_DURING_DEPLOYMENT: 1
  PYTHON_PATH: /home/site/wwwroot

build:
  commands:
    - python -m pip install --upgrade pip
    - pip install --no-cache-dir -r requirements.txt

startup_command: gunicorn --bind=0.0.0.0:8000 wsgi:application

post_deploy:
  commands:
    - mkdir -p /home/site/wwwroot/logs
    - mkdir -p /home/site/wwwroot/data
    - mkdir -p /home/site/wwwroot/uploads
    - chmod +x startup.sh

routes:
  - route: /
    rewrite: /
  - route: /static/*
    rewrite: /static/{0}
  - route: /uploads/*
    rewrite: /uploads/{0} 